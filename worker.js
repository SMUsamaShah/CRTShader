(function(){"use strict";let s,o=null;function f(){return(o===null||o.byteLength===0)&&(o=new Uint8Array(s.memory.buffer)),o}let c=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});c.decode();const y=2146435072;let _=0;function d(e,t){return _+=t,_>=y&&(c=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}),c.decode(),_=t),c.decode(f().subarray(e,e+t))}function u(e,t){return e=e>>>0,d(e,t)}let g=0;function p(e,t){const n=t(e.length*1,1)>>>0;return f().set(e,n/1),g=e.length,n}function m(e){return e==null}function A(e){const t=s.__wbindgen_externrefs.get(e);return s.__externref_table_dealloc(e),t}function h(e,t){return e=e>>>0,f().subarray(e/1,e/1+t)}function R(e,t){const n=p(e,s.__wbindgen_malloc),r=g,i=s.process_image(n,r,m(t)?4294967297:t>>>0);if(i[3])throw A(i[2]);var a=h(i[0],i[1]).slice();return s.__wbindgen_free(i[0],i[1]*1,1),a}const E=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>s.__wbg_config_free(e>>>0,1));class l{__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,E.unregister(this),t}free(){const t=this.__destroy_into_raw();s.__wbg_config_free(t,0)}get k_colors(){return s.__wbg_get_config_k_colors(this.__wbg_ptr)>>>0}set k_colors(t){s.__wbg_set_config_k_colors(this.__wbg_ptr,t)}}Symbol.dispose&&(l.prototype[Symbol.dispose]=l.prototype.free);const S=new Set(["basic","cors","default"]);async function W(e,t){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,t)}catch(r){if(e.ok&&S.has(e.type)&&e.headers.get("Content-Type")!=="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}else{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}function T(){const e={};return e.wbg={},e.wbg.__wbg___wbindgen_throw_b855445ff6a94295=function(t,n){throw new Error(u(t,n))},e.wbg.__wbindgen_cast_2241b6af4c4b2941=function(t,n){return u(t,n)},e.wbg.__wbindgen_init_externref_table=function(){const t=s.__wbindgen_externrefs,n=t.grow(4);t.set(0,void 0),t.set(n+0,void 0),t.set(n+1,null),t.set(n+2,!0),t.set(n+3,!1)},e}function x(e,t){return s=e.exports,b.__wbindgen_wasm_module=t,o=null,s.__wbindgen_start(),s}async function b(e){if(s!==void 0)return s;typeof e<"u"&&(Object.getPrototypeOf(e)===Object.prototype?{module_or_path:e}=e:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof e>"u"&&(e=new URL(""+new URL("assets/spritefusion_pixel_snapper_bg-B54QY3P4.wasm",self.location.href).href,self.location.href));const t=T();(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:r}=await W(await e,t);return x(n,r)}let w=!1;self.onmessage=async function(e){const{id:t,imageData:n,kColors:r}=e.data;try{w||(await b(),w=!0);const i=new Uint8Array(n),a=R(i,r),M={id:t,success:!0,result:Array.from(a)};self.postMessage(M)}catch(i){const a={id:t,success:!1,error:i};self.postMessage(a)}}})();
